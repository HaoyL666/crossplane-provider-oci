apiVersion: database.oci.upbound.io/v1alpha1
kind: Database
metadata:
  annotations:
    meta.upbound.io/example-id: database/v1alpha1/database
  labels:
    testing.upbound.io/example-name: test_database
  name: test-database
spec:
  forProvider:
    database:
    - adminPasswordSecretRef:
        key: example-key
        name: example-secret
        namespace: upbound-system
      backupIdSelector:
        matchLabels:
          testing.upbound.io/example-name: test_backup
      backupTdePasswordSecretRef:
        key: example-key
        name: example-secret
        namespace: upbound-system
      characterSet: ${var.database_database_character_set}
      databaseAdminPasswordSecretRef:
        key: example-key
        name: example-secret
        namespace: upbound-system
      databaseSoftwareImageIdSelector:
        matchLabels:
          testing.upbound.io/example-name: test_database_software_image
      dbBackupConfig:
      - autoBackupEnabled: ${var.database_database_db_backup_config_auto_backup_enabled}
        autoBackupWindow: ${var.database_database_db_backup_config_auto_backup_window}
        autoFullBackupDay: ${var.database_database_db_backup_config_auto_full_backup_day}
        autoFullBackupWindow: ${var.database_database_db_backup_config_auto_full_backup_window}
        backupDeletionPolicy: ${var.database_database_db_backup_config_backup_deletion_policy}
        backupDestinationDetails:
        - backupRetentionPolicyOnTerminate: ${var.database_database_db_backup_config_backup_destination_details_backup_retention_policy_on_terminate}
          dbrsPolicyIdSelector:
            matchLabels:
              testing.upbound.io/example-name: test_policy
          id: ${var.database_database_db_backup_config_backup_destination_details_id}
          isRemote: ${var.database_database_db_backup_config_backup_destination_details_is_remote}
          isRetentionLockEnabled: ${var.database_database_db_backup_config_backup_destination_details_is_retention_lock_enabled}
          remoteRegion: ${var.database_database_db_backup_config_backup_destination_details_remote_region}
          type: ${var.database_database_db_backup_config_backup_destination_details_type}
        recoveryWindowInDays: ${var.database_database_db_backup_config_recovery_window_in_days}
        runImmediateFullBackup: ${var.database_database_db_backup_config_run_immediate_full_backup}
      dbName: ${var.database_database_db_name}
      dbUniqueName: ${var.database_database_db_unique_name}
      dbWorkload: ${var.database_database_db_workload}
      definedTags: ${var.database_database_defined_tags}
      encryptionKeyLocationDetails:
      - awsEncryptionKeyIdSelector:
          matchLabels:
            testing.upbound.io/example-name: test_key
        azureEncryptionKeyIdSelector:
          matchLabels:
            testing.upbound.io/example-name: test_key
        googleCloudProviderEncryptionKeyIdSelector:
          matchLabels:
            testing.upbound.io/example-name: test_key
        hsmPasswordSecretRef:
          key: example-key
          name: example-secret
          namespace: upbound-system
        providerType: ${var.database_database_encryption_key_location_details_provider_type}
      freeformTags: ${var.database_database_freeform_tags}
      isActiveDataGuardEnabled: ${var.database_database_is_active_data_guard_enabled}
      key_store_id: ${oci_database_key_store.test_key_store.id}
      kmsKeyIdSelector:
        matchLabels:
          testing.upbound.io/example-name: test_key
      kmsKeyVersionIdSelector:
        matchLabels:
          testing.upbound.io/example-name: test_key_version
      ncharacterSet: ${var.database_database_ncharacter_set}
      pdbName: ${var.database_database_pdb_name}
      pluggableDatabases: ${var.database_database_pluggable_databases}
      protectionMode: ${var.database_database_protection_mode}
      sidPrefix: ${var.database_database_sid_prefix}
      sourceDatabaseIdSelector:
        matchLabels:
          testing.upbound.io/example-name: test_database
      sourceEncryptionKeyLocationDetails:
      - aws_encryption_key_id: ${oci_kms_key.test_key.id}
        azure_encryption_key_id: ${oci_kms_key.test_key.id}
        google_cloud_provider_encryption_key_id: ${oci_kms_key.test_key.id}
        hsmPasswordSecretRef:
          key: example-key
          name: example-secret
          namespace: upbound-system
        providerType: ${var.database_database_source_encryption_key_location_details_provider_type}
      sourceTdeWalletPasswordSecretRef:
        key: example-key
        name: example-secret
        namespace: upbound-system
      storageSizeDetails:
      - dataStorageSizeInGb: ${var.database_database_storage_size_details_data_storage_size_in_gb}
        recoStorageSizeInGbs: ${var.database_database_storage_size_details_reco_storage_size_in_gbs}
      tdeWalletPasswordSecretRef:
        key: example-key
        name: example-secret
        namespace: upbound-system
      transportType: ${var.database_database_transport_type}
      vaultIdSelector:
        matchLabels:
          testing.upbound.io/example-name: test_vault
    dbHomeIdSelector:
      matchLabels:
        testing.upbound.io/example-name: test_db_home
    dbVersion: ${var.database_db_version}
    kmsKeyIdSelector:
      matchLabels:
        testing.upbound.io/example-name: test_key
    kmsKeyVersionIdSelector:
      matchLabels:
        testing.upbound.io/example-name: test_key_version
    source: ${var.database_source}
