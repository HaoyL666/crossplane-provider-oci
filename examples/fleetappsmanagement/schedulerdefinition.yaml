apiVersion: fleetappsmanagement.oci.upbound.io/v1alpha1
kind: SchedulerDefinition
metadata:
  annotations:
    meta.upbound.io/example-id: fleetappsmanagement/v1alpha1/schedulerdefinition
  labels:
    testing.upbound.io/example-name: test_scheduler_definition
  name: test-scheduler-definition
spec:
  forProvider:
    actionGroups:
    - lifecycle_operation: ${var.scheduler_definition_action_groups_lifecycle_operation}
      product: ${var.scheduler_definition_action_groups_product}
      resource_id: ${var.test_active_fleet}
      runbookId: ${var.test_runbook_ocid}
      type: ${var.scheduler_definition_action_groups_type}
    activity_initiation_cut_off: ${var.scheduler_definition_activity_initiation_cut_off}
    compartmentIdSelector:
      matchLabels:
        testing.upbound.io/example-name: example
    description: ${var.scheduler_definition_description}
    displayName: ${var.scheduler_definition_display_name}
    freeformTags: ${var.scheduler_definition_freeform_tags}
    runBooks:
    - id: ${var.test_runbook_ocid}
      inputParameters:
      - arguments:
        - name: ${var.scheduler_definition_run_books_input_parameters_arguments_name}
          value: ${var.scheduler_definition_run_books_input_parameters_arguments_value}
        stepName: ${var.scheduler_definition_run_books_input_parameters_step_name}
    schedule:
    - duration: ${var.scheduler_definition_schedule_duration}
      executionStartdate: ${var.scheduler_definition_schedule_execution_startdate}
      maintenanceWindowIdSelector:
        matchLabels:
          testing.upbound.io/example-name: test_maintenance_window
      recurrences: ${var.scheduler_definition_schedule_recurrences}
      type: ${var.scheduler_definition_schedule_type}

---

apiVersion: fleetappsmanagement.oci.upbound.io/v1alpha1
kind: MaintenanceWindow
metadata:
  annotations:
    meta.upbound.io/example-id: fleetappsmanagement/v1alpha1/schedulerdefinition
  labels:
    testing.upbound.io/example-name: test_maintenance_window
  name: test-maintenance-window
spec:
  forProvider:
    compartmentIdSelector:
      matchLabels:
        testing.upbound.io/example-name: example
    description: test maintenance window
    displayName: schedulerExampleMaintenanceWindow
    duration: ${var.scheduler_definition_schedule_duration}
    isOutage: false
    isRecurring: false
    maintenance_window_type: OPEN_ENDED
    task_initiation_cutoff: 1
    timeScheduleStart: ${var.scheduler_definition_schedule_execution_startdate}
